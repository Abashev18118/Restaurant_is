= SPEC-1: Информационная система управления рестораном
:sectnums:
:toc:

== Background

Современные рестораны требуют эффективного управления заказами, оплатами, меню и пользователями. Информационная система должна обеспечивать взаимодействие клиентов, официантов, поваров и администраторов через удобный интерфейс. Важными аспектами являются мониторинг, логирование и аналитика данных.

== Requirements

=== Must-have (Обязательные)

- Регистрация и аутентификация пользователей (клиенты, администраторы, официанты, повара).
- Управление заказами (создание, обновление, статусы, уведомления).
- Интеграция с платежной системой для онлайн-оплат (заглушка).
- Управление меню (CRUD-операции с блюдами, категориями, ценами).
- Система отчетности и аналитики (реплики баз данных для BI-инструмента Metabase).
- Логирование событий и мониторинг работы системы.

=== Should-have (Желательные)

- Поддержка программ лояльности и скидок.
- Интеграция с внешними сервисами доставки.
- Ролевое управление доступом (RBAC).

=== Could-have (Дополнительные)

- Автоматизация обработки заказов с помощью ML-модели (например, предсказание популярности блюд).
- Поддержка push-уведомлений и SMS-информирования.

=== Won't-have (Не планируется на текущий этап)

- Поддержка нескольких ресторанов в одной системе.
- Голосовое управление заказами.

== Method

=== Архитектурный стиль

- Микросервисная архитектура.
- API Gateway для управления запросами.
- Асинхронное взаимодействие (Kafka / RabbitMQ для событий).
- Репликация БД для аналитики (Metabase).

=== Технологический стек

- **Бэкенд:** Go (Gin/Gorilla Mux)
- **Фронтенд:** React (Next.js / Vite)
- **База данных:** PostgreSQL (отдельная БД на сервис)
- **Сообщения:** Kafka / RabbitMQ
- **Мониторинг:** Prometheus + Grafana
- **Логирование:** Loki + Grafana

=== Основные сервисы

1. **AuthService** – Аутентификация (JWT, RBAC).
2. **UserService** – Управление пользователями.
3. **MenuService** – Управление меню.
4. **OrderService** – Управление заказами.
5. **PaymentService** – Обработка платежей (заглушка).

=== Структура базы данных

Каждый сервис имеет свою базу данных (PostgreSQL):

**AuthServiceDB:**

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(255) UNIQUE,
    password_hash TEXT,
    role VARCHAR(50) CHECK (role IN ('admin', 'waiter', 'chef', 'customer'))
);
```

**MenuServiceDB:**

```sql
CREATE TABLE menu_items (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    description TEXT,
    price DECIMAL(10,2),
    category VARCHAR(50)
);
```

**OrderServiceDB:**

```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INT,
    status VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**PaymentServiceDB:**

```sql
CREATE TABLE payments (
    id SERIAL PRIMARY KEY,
    order_id INT,
    amount DECIMAL(10,2),
    status VARCHAR(50),
    payment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

== Implementation

### **Этапы разработки (2 месяца)**

#### **Неделя 1: Инфраструктура и архитектура**

- Настроить репозитории (GitHub/GitLab).
- Настроить CI/CD (Docker, Kubernetes, PostgreSQL).
- Развернуть API Gateway и базовый роутинг.

#### **Неделя 2: Аутентификация и управление пользователями**

- Разработать **AuthService** (JWT, регистрация, вход).
- Реализовать **UserService** (CRUD пользователей, RBAC).
- Подключить API Gateway для проверки токенов.
- Начать разработку UI (страницы входа/регистрации).

#### **Неделя 3: Управление меню**

- Разработать **MenuService** (CRUD блюд, категории).
- Подключить к фронтенду (страницы меню, редактирование).

#### **Неделя 4: Заказы и обработка событий**

- Разработать **OrderService** (создание/обновление заказов).
- Интеграция с Kafka/RabbitMQ для событий.
- Добавить интерфейсы заказов на фронтенде (клиент, официант, повар).

#### **Неделя 5: Платежи (заглушка) и финальная сборка**

- Разработать **PaymentService** (заглушка).
- Подключить к **OrderService** (изменение статуса заказа после оплаты).
- Завершить разработку UI (страница оплаты, статусы заказов).

#### **Неделя 6-8: Тестирование, отладка, развертывание**

- Интеграционное тестирование API и UI.
- Настроить мониторинг (Prometheus, Grafana, Loki).
- Финальный деплой в Kubernetes.

== Gathering Results

### **Критерии успешности**

#### **1. Функциональность**

- Все основные сервисы работают корректно.
- Возможность создавать заказы, редактировать меню и управлять пользователями.
- Платёжная заглушка успешно меняет статус заказа.

#### **2. Производительность**

- Система выдерживает **500-1000 одновременных пользователей**.
- Среднее время отклика API **≤ 200 мс**.

#### **3. UI/UX**

- Интерфейс удобен для клиентов, официантов, поваров и администраторов.
- Минимальное количество кликов для оформления заказа.
- Поддержка мобильных устройств.

#### **4. Масштабируемость**

- Возможность интеграции с реальной платёжной системой.
- Готовность к добавлению доставки и других фич.

---
